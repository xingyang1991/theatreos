# TheatreOS 阿里云部署与交付报告

**项目:** TheatreOS 全栈应用
**部署目标:** 阿里云 ECS (华东 2 上海)
**AI服务:** 阿里云通义千问 (DashScope)
**报告日期:** 2025年12月25日

---

## 1. 部署概述

本次任务成功将 TheatreOS 全栈应用部署至您指定的阿里云账户，并完成了从 OpenAI 到通义千问 AI 服务的切换。应用目前已稳定运行，您可以通过公网IP地址访问。

**核心完成事项：**

- **基础设施创建:** 在阿里云华东2（上海）地域成功创建了一台ECS服务器实例。
- **环境配置:** 完成了服务器的操作系统、安全组、网络以及运行环境（Python, Node.js, Nginx）的配置。
- **后端部署:** TheatreOS 后端 FastAPI 应用已成功部署，并配置为 systemd 服务，实现开机自启和稳定运行。
- **前端部署:** TheatreOS 前端 React 应用已完成生产环境构建，并通过 Nginx 进行了部署和反向代理配置。
- **AI服务集成:** 已将应用的内容生成模块从 OpenAI 切换为阿里云通义千问，并使用您提供的 API Key 完成了配置和测试。
- **端到端验证:** 部署完成后，已成功通过 API 创建了一个新的剧场实例，验证了前后端通信、数据库连接和核心功能的正确性。

## 2. 访问信息

您现在可以通过以下地址访问 TheatreOS 应用：

| 资源 | 地址 |
| :--- | :--- |
| **Web应用访问地址** | `http://120.55.162.182` |
| **API 健康检查** | `http://120.55.162.182/health` |

## 3. 服务器管理信息

为了您后续对服务器进行管理和维护，以下是服务器的详细登录信息。请妥善保管，不要泄露。

| 项目 | 信息 |
| :--- | :--- |
| **公网 IP 地址** | `120.55.162.182` |
| **服务器地域** | 华东 2 (上海) |
| **实例 ID** | `i-uf62wrmhcqv36ffje1m5` |
| **操作系统** | Ubuntu 22.04 LTS |
| **登录用户名** | `root` |
| **登录密码** | `TheatreOS@2024!` |

**如何登录服务器:**

您可以使用任何 SSH 客户端通过以下命令登录服务器：

```bash
ssh root@120.55.162.182
```

登录时会提示您输入密码。

## 4. 部署架构概览

应用采用前后端分离的经典架构部署：

- **Nginx (Web 服务器):** 作为流量入口，监听 80 端口。它负责两项主要任务：
  1.  处理对根路径 `/` 的访问，提供前端静态资源（HTML, CSS, JavaScript）。
  2.  作为反向代理，将所有 API 请求（如 `/v1/...`）转发到在 8000 端口运行的后端服务。

- **TheatreOS 前端 (React):** 静态文件位于 `/opt/theatreos/frontend` 目录，由 Nginx 直接提供服务。

- **TheatreOS 后端 (FastAPI):** 运行在 `http://127.0.0.1:8000`，由名为 `theatreos-backend` 的 systemd 服务管理。应用代码位于 `/opt/theatreos/backend`。

## 5. 服务管理

后端应用已配置为系统服务，您可以通过 SSH 登录服务器后，使用以下命令进行管理：

- **查看服务状态:**
  ```bash
  systemctl status theatreos-backend
  ```

- **重启服务:**
  ```bash
  systemctl restart theatreos-backend
  ```

- **停止服务:**
  ```bash
  systemctl stop theatreos-backend
  ```

- **查看实时日志:**
  ```bash
  journalctl -u theatreos-backend -f
  ```

## 6. 后续建议

- **配置域名和HTTPS:** 为了安全和专业性，建议您注册一个域名，并配置 HTTPS 加密访问。我可以协助您完成此项配置。
- **数据库迁移:** 目前应用使用的是 SQLite 文件数据库，适合开发和测试。对于生产环境，建议迁移到更专业的数据库服务，如阿里云的 RDS (PostgreSQL 或 MySQL)。
- **成本监控:** ECS 实例是按量付费的，请关注您的阿里云账户余额，避免因欠费导致服务中断。

本次部署任务已全部完成。如果您有任何疑问或需要进一步的协助，请随时提出。
